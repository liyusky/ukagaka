<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./css/map.css">
  <link rel="stylesheet" href="./css/rank.css">
  <link rel="stylesheet" href="./css/reset.css">
  <link rel="stylesheet" href="./css/animate.css">
  <link rel="stylesheet" href="./css/components.css">
  <link rel="stylesheet" href="./css/transaction.css">
  <script src="./scripts/jquery-3.3.1.min.js"></script>
  <script src="./scripts/echarts.min.js"></script>
  <script src="./scripts/china.js"></script>
  <script src="./scripts/geography.js"></script>
  <script src="./scripts/points.js"></script>
  <script src="./scripts/provices.js"></script>
  <script src="./scripts/customers.js"></script>
  <script src="./scripts/customer-index.js"></script>
  <script src="./scripts/ChinaMap.class.js"></script>
  <script src="./scripts/Transaction.class.js"></script>
  <script src="./scripts/Rank.class.js"></script>
  <script src="./scripts/Balance.class.js"></script>
  <!-- <script src="./scripts/map.js"></script> -->
</head>

<body>

  <section class="volume">
    <ul>
      <li class="trade">
        <div class="today-trade" id="today-trade"></div>
      </li>
      <li class="trade">
        <p class="trade-msg">今日交易额(元)</p>
      </li>
      <li class="trade">
        <div class="accumulate-trade" id="accumulate-trade"></div>
      </li>
      <li class="trade">
        <p class="trade-msg mar21">累计交易额(元)</p>
      </li>
      <li class="trade mt37">
        <p class="trade-msg mar21 fz24">平均每笔交易(元):</p>
        <div class="average-trade" id="average-trade"></div>
      </li>
      <li class="trade">
        <p class="trade-msg fz24">近1分钟注册用户(人):</p>
        <div class="nearlyone" id="nearlyone">
        </div>
      </li>
      <div class="clear"></div>
      <li class="trade">
        <p class="trade-msg fz24">近1分钟交易笔数(数):</p>
        <div class="transaction-one" id="transaction-one"></div>
      </li>
    </ul>
  </section>
  <section class="tradecount">
    <ul>
      <li>
        <div class="today-count" id="today-count">
        </div>
      </li>
      <li>
        <p class="trade-msg">今日交易笔数(笔)</p>
      </li>
      <li>
        <div class="accumutrans" id="accumutrans">
        </div>
      </li>
      <li>
        <p class="trade-msg">累计交易笔数(笔)</p>
      </li>
    </ul>
  </section>
  <section class="register-count">
    <ul>
      <li>
        <div class="today-register" id="today-register">
        </div>
      </li>
      <li>
        <p class="register-msg">今日注册用户(人)</p>
      </li>
      <li>
        <div class="accumulatedUser" id="accumulatedUser">
        </div>
      </li>
      <li class="register-msg">累计交易用户数(人)</li>
    </ul>
  </section>

  <section class="transaction">
    <header class="transaction-header">
      <div>城市</div>
      <div>姓名</div>
      <div>交易金额(元)</div>
      <div>时间</div>
    </header>
    <div class="transaction-wrap">
      <ul class="wrap-content" id="transaction-content"></ul>
    </div>
  </section>
  <section class="china-map">
    <div class="map" id="map"></div>
    <div class="tips" id="tips"></div>
  </section>
  <section class="rank">
    <header class="rank-header">
      <p>交易用户省份TOP10</p>
      <img class="header-arrow" src="./images/arrow.png">
    </header>
    <ul class="rank-list" id="rank">
      <li class="list-item hide">
        <div class="item-sequence">
          <img class="sequence-sign" src="./images/top-1.png">
        </div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">
          <img class="sequence-sign" src="./images/top-2.png">
        </div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">
          <img class="sequence-sign" src="./images/top-3.png">
        </div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">4</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">5</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">6</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">7</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">8</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">9</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
      <li class="list-item hide">
        <div class="item-sequence">10</div>
        <div class="item-name"></div>
        <div class="item-link">
          <div class="link-rail"></div>
        </div>
        <div class="item-num"></div>
      </li>
    </ul>
  </section>
  <script>
    const ws = new WebSocket("ws://47.98.42.150:8900");
    switch (ws.readyState) {
      case WebSocket.CLOSING:
        refresh();
        break;
      case WebSocket.CLOSED:
        refresh();
        break;
    }
  </script>
  <script>
    window.onload = function () {
      const componentInstanceArr = [
        new Rank(),
        new ChinaMap(),
        new Transaction(),
        new Balance()
      ];
      ws.addEventListener('message', message => {
        componentInstanceArr.forEach(item => {
          listener(item, message);
        });
      })
    }

    function listener(componentInstance, message) {
      try {
        componentInstance.mount(message);
      } catch (error) {
        setTimeout(() => {
          location.reload();
        }, 5000);
      }
    }
  </script>
  <script>
  </script>
</body>

</html>